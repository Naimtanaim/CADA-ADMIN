<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Label Pallet - Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <style>
    :root{
      --card-width-mm: 80mm;
      --card-height-mm: 59mm;
      --gap-mm: 3mm;
    }
    body {
      font-family: "Noto Sans", "Segoe UI", Arial, sans-serif;
      margin: 18px;
      background: #f7f7f7;
      color: #111;
    }
    .controls {
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-bottom:14px;
    }
    .controls label { font-size:14px; }
    .controls input[type="number"]{
      padding:8px 10px;
      font-size:16px;
      border:1px solid #ccc;
      border-radius:4px;
      width:100px;
    }
    .controls button{
      padding:10px 14px;
      font-size:15px;
      border:none;
      background:#1a73e8;
      color:#fff;
      border-radius:6px;
      cursor:pointer;
    }
    .controls button.secondary{
      background:#4caf50;
    }
    .sheet {
      width: 210mm;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-auto-rows: auto;
      gap: var(--gap-mm);
      padding: 8mm;
      box-sizing: border-box;
      background:white;
    }
    .card {
      box-sizing: border-box;
      border: 2px solid #000;
      height: var(--card-height-mm);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:6px;
    }
    .card-top {
      display:flex;
      align-items:flex-start;
      gap:8px;
    }
    .left-top{
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      gap:15px;
      width:55%;
    }
    .small-label{ font-size:15px; }
    .big-jp{
      font-family: "Noto Serif", "Times New Roman", serif;
      font-size:38px;
      line-height:0.5;
      letter-spacing:2px;
    }
    .right-top{
      width:50%;
      text-align:center;
      border-left:2px solid #000;
      padding-left:6px;
    }
    .no-label{ font-size:19px; text-align:right; color:#333; }
    .big-number{
      font-size:56px;
      font-weight:500;
      line-height:0.9;
      margin-top:6px;
    }
    .card-mid {
      border-top:2px solid #000;
      border-bottom:2px solid #000;
      padding:6px;
      text-align:center;
      font-size:15px;
      font-weight:400;
    }
    .card-bottom{
      padding-top:1px;
      display:flex;
      align-items:center;
      justify-content:center;
      height:34%;
    }
    .barcode-svg{ width:90%; height:50px; }
@media print {
  body { margin:0; }
  .controls { display:none; }

  /* Atur ukuran halaman print */
  .sheet {
    margin: 0 auto;
    padding: 0.5cm;
    background: white;
    width: 21cm;    /* lebar A4 */
    height: 29.7cm; /* tinggi A4 */
    box-sizing: border-box;
  }

  .card {
    page-break-inside: avoid;
    width: 8.6cm;   /* contoh ukuran kartu ID standar */
    height: 5.4cm;
    margin: 0.2cm;
  }
}

  </style>
</head>
<body>

  <div class="controls">
    <label>Nomor awal:
      <input id="startNumber" type="number" min="1" value="1" />
    </label>
    <label>Nomor akhir:
      <input id="endNumber" type="number" min="1" value="8" />
    </label>
    <button id="generateBtn">Generate</button>
    <button id="printBtn" class="secondary">Print</button>
  </div>

  <div class="sheet" id="sheet"></div>

  <script>
    const sheet = document.getElementById('sheet');
    const generateBtn = document.getElementById('generateBtn');
    const printBtn = document.getElementById('printBtn');

    function createCard(number){
      const wrapper = document.createElement('div');
      wrapper.className = 'card';
      wrapper.innerHTML = `
        <div class="card-top">
          <div class="left-top">
            <div class="small-label">単位</div>
            <div class="big-jp">出貨課</div>
          </div>
          <div class="right-top">
            <div class="no-label">No / palett</div>
            <div class="big-number">${number}</div>
          </div>
        </div>
        <div class="card-mid">出貨棧板作業</div>
        <div class="card-bottom">
          <svg class="barcode-svg" jsbarcode-format="CODE128" jsbarcode-value="${number}" jsbarcode-textmargin="0" jsbarcode-height="56"></svg>
        </div>
      `;
      return wrapper;
    }

    function generateAll(){
      const start = parseInt(document.getElementById('startNumber').value) || 1;
      const end = parseInt(document.getElementById('endNumber').value) || start;
      sheet.innerHTML = '';
      for(let num=start; num<=end; num++){
        const card = createCard(num);
        sheet.appendChild(card);
      }
      // render barcode
      const svgs = sheet.querySelectorAll('svg[jsbarcode-value]');
      svgs.forEach(svg=>{
        JsBarcode(svg, svg.getAttribute('jsbarcode-value'), {
          format: "CODE128",
          displayValue: false,
          height: 56,
          margin: 0,
          width: 2
        });
      });
    }

    generateBtn.addEventListener('click', generateAll);
    printBtn.addEventListener('click', ()=>{ generateAll(); window.print(); });
    window.addEventListener('load', generateAll);
  </script>
</body>
</html>
